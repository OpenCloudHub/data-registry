stages:
  download:
    cmd: python scripts/download.py
    deps:
      - scripts/download.py
    params:
      - download
    outs:
      - ../../data/radiology-mini/raw/images
      - ../../data/radiology-mini/raw/captions.json

  process:
    cmd: python scripts/process.py
    deps:
      - scripts/process.py
      - ../../data/radiology-mini/raw
    params:
      - process
    outs:
      - ../../data/radiology-mini/processed/train
      - ../../data/radiology-mini/processed/test
    metrics:
      - ../../data/radiology-mini/processed/process_stats.json:
          cache: false

  analyze:
    cmd: python scripts/analyze.py
    deps:
      - scripts/analyze.py
      - ../../data/radiology-mini/processed/train
      - ../../data/radiology-mini/processed/test
      - ../../data/radiology-mini/processed/process_stats.json
    params:
      - analyze
    metrics:
      - ../../data/radiology-mini/metadata.json:
          cache: false